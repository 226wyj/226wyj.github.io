<!DOCTYPE html><html lang="zh-cmn-Hans" prefix="og: http://ogp.me/ns#" class="han-init"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" /><title>Leetcode 224. Basic Calculator &mdash; Wu</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/226wyj/226wyj.github.io@master/assets/vendor/primer-css/css/primer.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/226wyj/226wyj.github.io@master/assets/css/components/collection.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/226wyj/226wyj.github.io@master/assets/css/components/repo-card.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/226wyj/226wyj.github.io@master/assets/css/sections/repo-list.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/226wyj/226wyj.github.io@master/assets/css/components/boxed-group.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/226wyj/226wyj.github.io@master/assets/css/globals/common.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/226wyj/226wyj.github.io@master/assets/css/globals/responsive.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/226wyj/226wyj.github.io@master/assets/css/posts/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/226wyj/226wyj.github.io@master/assets/vendor/octicons/octicons/octicons.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/mzlogin/rouge-themes@master/dist/github.css"><link rel="canonical" href="https://226wyj.github.io/2021/12/27/Leetcode-224/"><link rel="alternate" type="application/atom+xml" title="Wu" href="https://226wyj.github.io/feed.xml"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/226wyj/226wyj.github.io@master/favicon.ico"><meta property="og:title" content="Leetcode 224. Basic Calculator"><meta name="keywords" content="Leetcode, Basic Calculator, Stack"><meta name="og:keywords" content="Leetcode, Basic Calculator, Stack"><meta name="description" content="This article will introduce a tempelate solution for solving Basic Calculator problems. Using the following method, you are able to conquer the following three problems:"><meta name="og:description" content="This article will introduce a tempelate solution for solving Basic Calculator problems. Using the following method, you are able to conquer the following three problems:"><meta property="og:url" content="https://226wyj.github.io/2021/12/27/Leetcode-224/"><meta property="og:site_name" content="Wu"><meta property="og:type" content="article"><meta property="og:locale" content="zh_CN" /><meta property="article:published_time" content="2021-12-27"> <script src="https://cdn.jsdelivr.net/gh/226wyj/226wyj.github.io@master/assets/vendor/jquery/dist/jquery.min.js"></script> <script src="https://cdn.jsdelivr.net/gh/226wyj/226wyj.github.io@master/assets/js/jquery-ui.js"></script> <script src="https://cdn.jsdelivr.net/gh/226wyj/226wyj.github.io@master/assets/js/main.js"></script></head><body class="" data-mz=""><header class="site-header"><div class="container"><h1><a href="https://226wyj.github.io/" title="Wu"><span class="octicon octicon-mark-github"></span> Wu</a></h1><button class="collapsed mobile-visible" type="button" onclick="toggleMenu();"> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button><nav class="site-header-nav" role="navigation"> <a href="https://226wyj.github.io/" class=" site-header-nav-item" target="" title="Home">Home</a> <a href="https://226wyj.github.io/categories/" class=" site-header-nav-item" target="" title="Categories">Categories</a> <a href="https://226wyj.github.io/wiki/" class=" site-header-nav-item" target="" title="Wiki">Wiki</a> <a href="https://226wyj.github.io/links/" class=" site-header-nav-item" target="" title="Link">Link</a> <a href="https://226wyj.github.io/about/" class=" site-header-nav-item" target="" title="About">About</a></nav></div></header><section class="collection-head small geopattern" data-pattern-id="Leetcode 224. B"><div class="container"><div class="columns"><div class="column three-fourths"><div class="collection-title"><h1 class="collection-header">Leetcode 224. Basic Calculator</h1><div class="collection-info"> <span class="meta-info"> <span class="octicon octicon-calendar"></span> 2021/12/27 </span> <span class="meta-info"> <span class="octicon octicon-file-directory"></span> <a href="https://226wyj.github.io/categories/#Leetcode" title="Leetcode">Leetcode</a> </span> <span class="meta-info"> <span class="octicon octicon-clock"></span> 共 2754 字，约 8 分钟 </span></div></div></div><div class="column one-fourth mobile-hidden"><div class="collection-title"></div></div></div></div></section><section class="container content"><div class="columns"><div class="column three-fourths" ><article class="article-content markdown-body"><p>This article will introduce a tempelate solution for solving <code class="language-plaintext highlighter-rouge">Basic Calculator</code> problems. Using the following method, you are able to conquer the following three problems:</p><p><a href="https://leetcode.com/problems/basic-calculator/">224. Basic Calculator</a></p><p><a href="https://leetcode.com/problems/basic-calculator-ii/">227. Basic Calculator II</a></p><p><a href="https://leetcode.com/problems/basic-calculator-iii/">772. Basic Calculator III</a></p><h2 id="problem-description">Problem Description</h2><p>Given a string s representing a valid expression, implement a basic calculator to evaluate it, and return the result of the evaluation.</p><p>Note: You are not allowed to use any built-in function which evaluates strings as mathematical expressions, such as eval().</p><h2 id="example">Example</h2><p><strong>Example 1:</strong></p><div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Input: s = "1 + 1"
Output: 2
</code></pre></div></div><p><strong>Example 2:</strong></p><div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Input: s = " 2-1 + 2 "
Output: 3
</code></pre></div></div><p><strong>Example 3:</strong></p><div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Input: s = "(1+(4+5+2)-3)+(6+8)"
Output: 23
</code></pre></div></div><h2 id="solution">Solution</h2><ol><li>Use two stacks, one for storing the operands, and the other for storing the operators.</li><li>For each operator, use a hash map to mark the priority relations among them. The operator with higher priority will have a larger value, and two operators with the same priority will have the same value.</li><li><p>The original expression may have spaces, parenthesis, and negative numbers in it, so to make it a normal format, we would carry the following steps:</p><ul><li>Add a pair of parenthesis at the outermost of the expression.</li><li>Delete all the spaces in the expression.</li><li>Replace the string in the format of ‘(-‘ into ‘(0-‘, so that we won’t need to pay attention to the operations among negative numbers.</li></ul></li><li><p>For each character in the expression string, there may be the following possibilities:</p><ul><li>If the character is a digit, then find all the continuous digits, convert them into an integer, and push the integer into the operand stack.</li><li>If the character is a left parenthesis, then push it into the operator stack.</li><li>If the character is a right parenthesis, then compute the sub-expression’s value based on current state of the two stacks until find the left parenthesis in the operator stack. Then pop the left parenthesis and push the computed value into the operand stack, which means we have finished computing the value of the sub-expression between the pair of parenthesis.</li><li>If the character is an arithmetic operator, then before pushing it into the operator stack, we should compute the current sub-expression until we meet an operator in the operator stack whose priority is smaller than the current character.</li></ul></li><li>After iterating and processing all the characters in the expression string, there should be only one number left in the operand stack, return it.</li></ol><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_stack</span><span class="p">,</span> <span class="n">op_stack</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">num_stack</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">op_stack</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">num_stack</span><span class="p">.</span><span class="n">pop</span><span class="p">(),</span> <span class="n">num_stack</span><span class="p">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="n">op</span> <span class="o">=</span> <span class="n">op_stack</span><span class="p">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="n">res</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">op</span> <span class="o">==</span> <span class="s">'+'</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
        <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s">'-'</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">y</span>
        <span class="n">num_stack</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">op_prio</span> <span class="o">=</span> <span class="p">{</span><span class="s">'+'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">'-'</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s">'('</span> <span class="o">+</span> <span class="n">s</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">' '</span><span class="p">,</span> <span class="s">''</span><span class="p">)</span> <span class="o">+</span> <span class="s">')'</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">"(-"</span><span class="p">,</span> <span class="s">"(0-"</span><span class="p">)</span>
        <span class="n">num_stack</span><span class="p">,</span> <span class="n">op_stack</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="n">c</span><span class="p">.</span><span class="n">isdigit</span><span class="p">():</span>
                <span class="n">num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
                <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="ow">and</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">isdigit</span><span class="p">():</span>
                    <span class="n">num</span> <span class="o">=</span> <span class="n">num</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">num_stack</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="s">'('</span><span class="p">:</span>
                <span class="n">op_stack</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="s">')'</span><span class="p">:</span>
                <span class="k">while</span> <span class="n">op_stack</span> <span class="ow">and</span> <span class="n">op_stack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s">'('</span><span class="p">:</span>
                    <span class="bp">self</span><span class="p">.</span><span class="n">compute</span><span class="p">(</span><span class="n">num_stack</span><span class="p">,</span> <span class="n">op_stack</span><span class="p">)</span>
                <span class="n">op_stack</span><span class="p">.</span><span class="n">pop</span><span class="p">()</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">while</span> <span class="n">op_stack</span> <span class="ow">and</span> <span class="n">op_stack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s">'('</span><span class="p">:</span>
                    <span class="n">pre_op</span> <span class="o">=</span> <span class="n">op_stack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">op_prio</span><span class="p">[</span><span class="n">pre_op</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">op_prio</span><span class="p">[</span><span class="n">c</span><span class="p">]:</span>
                        <span class="k">break</span>
                    <span class="bp">self</span><span class="p">.</span><span class="n">compute</span><span class="p">(</span><span class="n">num_stack</span><span class="p">,</span> <span class="n">op_stack</span><span class="p">)</span>
                <span class="n">op_stack</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">num_stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

</code></pre></div></div><div style="margin-top:2em;padding:0 1.5em;border:1px solid #d3d3d3;background-color:#deebf7"><h3>文档信息</h3><ul><li>本文作者：<a href="https://226wyj.github.io" target="_blank">Wu, Yuejiang</a></li><li>本文链接：<a href="https://226wyj.github.io/2021/12/27/Leetcode-224/" target="_blank">https://226wyj.github.io/2021/12/27/Leetcode-224/</a></li><li>版权声明：自由转载-非商用-非衍生-保持署名（<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh" target="_blank">创意共享3.0许可证</a>）</li></ul></div></article><div class="share"></div><div class="comment"><div id="gitalk-container"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/226wyj/226wyj.github.io@master/assets/vendor/gitalk/gitalk.css"> <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script> <script> var gitalk = new Gitalk({ id: '/2021/12/27/Leetcode-224/', clientID: '816a74632f6a9e1d895c', clientSecret: '69da216c45ee48df2f0e92506cf044cbc001ef2b', repo: 'blog-comment', owner: '226wyj', admin: ['226wyj'], labels: ['gitment'], perPage: 50, }); gitalk.render('gitalk-container'); </script></div></div><div class="column one-fourth"><h3>Search</h3><div id="site_search"> <input style="width:96%" type="text" id="search_box" placeholder="Search"></div><ul id="search_results" style="font-size:14px;list-style-type:none;padding-top:10px;padding-left:10px;"></ul><script src="https://cdn.jsdelivr.net/gh/226wyj/226wyj.github.io@master/assets/js/simple-jekyll-search.min.js"></script> <script type="text/javascript"> SimpleJekyllSearch({ searchInput: document.getElementById('search_box'), resultsContainer: document.getElementById('search_results'), json: 'https://226wyj.github.io/assets/search_data.json?v=1704763135', searchResultTemplate: '<li><a href="{url}" title="{title}">{title}</a></li>', noResultsText: 'No results found', limit: 10, fuzzy: false, exclude: ['Welcome'] }) </script><h3 class="post-directory-title mobile-hidden">Table of Contents</h3><div id="post-directory-module" class="mobile-hidden"><section class="post-directory"><dl></dl></section></div><script src="https://cdn.jsdelivr.net/gh/226wyj/226wyj.github.io@master/assets/js/jquery.toc.js"></script></div></div></section><footer class="container"><div class="site-footer" role="contentinfo"><div class="copyright left mobile-block"> © 2015 <span title="Wu, Yuejiang">Wu, Yuejiang</span> <a href="javascript:window.scrollTo(0,0)" class="right mobile-visible">TOP</a></div><ul class="site-footer-links right mobile-hidden"><li> <a href="javascript:window.scrollTo(0,0)" >TOP</a></li></ul><a href="https://github.com/226wyj/226wyj.github.io" target="_blank" aria-label="view source code"> <span class="mega-octicon octicon-mark-github" title="GitHub"></span> </a><ul class="site-footer-links mobile-hidden"><li> <a href="https://226wyj.github.io/" title="Home" target="">Home</a></li><li> <a href="https://226wyj.github.io/categories/" title="Categories" target="">Categories</a></li><li> <a href="https://226wyj.github.io/wiki/" title="Wiki" target="">Wiki</a></li><li> <a href="https://226wyj.github.io/links/" title="Link" target="">Link</a></li><li> <a href="https://226wyj.github.io/about/" title="About" target="">About</a></li><li><a href="https://226wyj.github.io/feed.xml"><span class="octicon octicon-rss" style="color:orange;"></span></a></li></ul></div></footer><div class="tools-wrapper"> <a class="gotop" href="#" title="回到顶部"><span class="octicon octicon-arrow-up"></span></a></div><script src="https://cdn.jsdelivr.net/gh/226wyj/226wyj.github.io@master/assets/js/geopattern.js"></script> <script> jQuery(document).ready(function($) { $('.geopattern').each(function(){ $(this).geopattern($(this).data('pattern-id')); }); /* hljs.initHighlightingOnLoad(); */ }); </script><div style="display:none"> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-80669434-1', 'auto'); ga('send', 'pageview'); </script></div></body></html>
